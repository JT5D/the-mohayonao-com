(function(){$(function(){"use strict";var e,t,n,r,i,s,o;t=80,r=(o=window.URL||window.webkitURL)!=null?o.createObjectURL:void 0,$(window).on("dragover",function(){return!1}),$(window).on("drop",function(e){var t=this;return n&&r&&n.preview(e.originalEvent.dataTransfer.files[0],function(){return n.getImage()}),!1}),i=function(){var e;return e=$("#container"),function(){return e.height(e.width()*.75|0),typeof n!="undefined"&&n!==null?n.resize():void 0}}(),$(window).on("resize",i),i();if(!r)return;return $("#shuffle").on("change",function(){return n.shuffle=!!$(this).attr("checked")}),s=function(e){var t,n,r;t=e.length;while(t)n=Math.floor(Math.random()*t--),r=[e[n],e[t]],e[t]=r[0],e[n]=r[1];return e},e=function(){function e(e){this.target=e,this.video=null,this.count=0,this.canvas=document.createElement("canvas"),this.canvas=this.canvas,this.context=this.canvas.getContext("2d"),this.shuffle=!1,this.resize()}return e.prototype.resize=function(){return $(this.canvas).width(this.canvas.width=this.width=$(this.target).width()),$(this.canvas).height(this.canvas.height=this.height=$(this.target).height())},e.prototype.preview=function(e,t){var n,i,s=this;return i=document.createElement("video"),n=e.type.substr(0,5),this.video=null,this.list=[],n==="video"&&i.canPlayType(e.type)&&($(i).on("loadeddata",function(){return s.initCanvas(),s.seek(t)}),$(i).on("seeked",function(){return s.draw(function(){return s.seek(t)})}),i.type=e.type,i.src=r(e),this.video=i),this.count=0},e.prototype.getImage=function(){var e,t=this;return e=new Image,e.onload=function(){return $(t.target).empty().append(e)},e.src=this.canvas.toDataURL("image/jpeg")},e.prototype.initCanvas=function(){var e,n,r,i,o,u,a,f,l,c,h,p;$(this.target).empty().append(this.canvas),f=[this.video.videoWidth,this.video.videoHeight],u=f[0],o=f[1],l=[t,t],n=l[0],e=l[1],u>o?(r=n*(o/u),c=[n,r],this.dw=c[0],this.dh=c[1]):(a=e*(u/o),h=[a,e],this.dw=h[0],this.dh=h[1]),this.dw|=0,this.dh|=0,this.lenX=Math.ceil(this.width/this.dw),this.lenY=Math.ceil(this.height/this.dh),this.context.clearRect(0,0,n,e),p=[u,o],this.sw=p[0],this.sh=p[1],this.list=function(){var e,t,n;n=[];for(i=e=0,t=this.lenX*this.lenY;0<=t?e<t:e>t;i=0<=t?++e:--e)n.push(this.video.duration*(i/(this.lenX*this.lenY)));return n}.call(this);if(this.shuffle)return this.list=s(this.list)},e.prototype.seek=function(e){var t;return t=this.list.shift(),!this.video||t===void 0?typeof e=="function"?e():void 0:this.video.currentTime=t},e.prototype.draw=function(e){var t,n;return t=this.count%this.lenX,n=this.count/this.lenX|0,this.context.drawImage(this.video,0,0,this.sw,this.sh,this.dw*t,this.dh*n,this.dw,this.dh),this.count+=1,typeof e=="function"?e():void 0},e}(),n=new e(document.getElementById("thumbs"))})}).call(this)